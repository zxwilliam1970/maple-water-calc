<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>楓之谷補品計算器</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
    h1 { color: #333; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #eee; }
    select, input { padding: 5px; margin: 5px; }
    .container { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
</style>
</head>
<body>

<div class="container">
<h1>楓之谷補品計算器</h1>

<h2>角色狀態</h2>
<label>血量(HP)：<input type="number" id="hp" value="1000"></label>
<label>魔力(MP)：<input type="number" id="mp" value="500"></label>
<label>魔攻：<input type="number" id="matk" value="100"></label>

<h2>技能選擇</h2>
<label>魔心防禦等級：
<select id="skill-moxin">
    <option value="0">無</option>
</select>
</label>

<label>毒霧等級：
<select id="skill-duwu">
    <option value="0">無</option>
</select>
</label>

<label>致命毒霧等級：
<select id="skill-zhimian">
    <option value="0">無</option>
</select>
</label>

<h2>補品資料</h2>
<table id="potionTable">
<thead>
<tr>
    <th>藥水名</th>
    <th>補量</th>
    <th>價格</th>
    <th>轉換率</th>
    <th>購買地</th>
</tr>
</thead>
<tbody>
<tr><td>蘋果</td><td>30</td><td>28</td><td>1.071</td><td>防衛本部</td></tr>
<tr><td>蘋果</td><td>30</td><td>30</td><td>1.000</td><td>其餘地圖</td></tr>
<tr><td>紅色藥水 / 雞蛋</td><td>50</td><td>47</td><td>1.064</td><td>玩具城、愛塔-糖果機、防衛本部</td></tr>
<tr><td>紅色藥水 / 雞蛋</td><td>50</td><td>50</td><td>1.000</td><td>其餘地圖</td></tr>
<!-- 這裡可以繼續加你的其他補品資料 -->
</tbody>
</table>

<button onclick="calc()">計算最佳補品</button>
<div id="result"></div>

</div>

<script>
const moxinData = [
    {level:1, rate:0.04},{level:2, rate:0.08},{level:3, rate:0.12},{level:4, rate:0.16},{level:5, rate:0.20},
    {level:6, rate:0.24},{level:7, rate:0.28},{level:8, rate:0.32},{level:9, rate:0.36},{level:10, rate:0.40},
    {level:11, rate:0.44},{level:12, rate:0.48},{level:13, rate:0.52},{level:14, rate:0.56},{level:15, rate:0.60},
    {level:16, rate:0.64},{level:17, rate:0.68},{level:18, rate:0.72},{level:19, rate:0.76},{level:20, rate:0.80}
];

function populateSkillSelect(id) {
    let select = document.getElementById(id);
    for (let i=1; i<=20; i++) {
        let opt = document.createElement("option");
        opt.value = i;
        opt.textContent = i;
        select.appendChild(opt);
    }
}

populateSkillSelect("skill-moxin");
populateSkillSelect("skill-duwu");
populateSkillSelect("skill-zhimian");

function calc() {
    let hp = parseFloat(document.getElementById("hp").value);
    let mp = parseFloat(document.getElementById("mp").value);
    let matk = parseFloat(document.getElementById("matk").value);

    let moxinLevel = parseInt(document.getElementById("skill-moxin").value);
    if (moxinLevel > 0) {
        let rate = moxinData[moxinLevel-1].rate;
        mp += mp * rate;
    }

    let rows = document.querySelectorAll("#potionTable tbody tr");
    let bestPotion = null;
    let bestRate = 0;
    rows.forEach(row => {
        let name = row.cells[0].textContent;
        let heal = parseFloat(row.cells[1].textContent);
        let price = parseFloat(row.cells[2].textContent);
        let rate = heal / price;
        if (rate > bestRate) {
            bestRate = rate;
            bestPotion = name;
        }
    });

    document.getElementById("result").innerHTML =
        `最佳補品：${bestPotion} (效率 ${bestRate.toFixed(3)})<br>` +
        `計算後 MP: ${mp.toFixed(0)}, 魔攻: ${matk}`;
}
</script>

</body>
</html>
